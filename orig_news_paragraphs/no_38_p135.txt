In late 2014, hackers working for Kim   the North’s young and unpredictable leader, had carried out a   attack on Sony Pictures Entertainment intended to stop the Christmastime release of a comedy about a C. I. A. plot to kill Mr. Kim. In that case, embarrassing emails had also been released. But the real damage was done to Sony’s own systems: More than 70 percent of its computers melted down when a particularly virulent form of malware was released. Within weeks, intelligence agencies traced the attack back to the North and its leadership. 