The federal Bureau of Alcohol, Tobacco, Firearms and Explosives said Mr. Mateen had legally bought a long gun and a pistol in the past week or two, though it was not clear whether those were the weapons used in the assault, which officials described as a handgun and an   type of assault rifle. A former   Daniel Gilroy, said Mr. Mateen had talked often about killing people and had voiced hatred of gays, blacks, women and Jews. Around the time of the massacre, Mr. Mateen called 911 and declared his allegiance to the Islamic State, the brutal group that has taken over parts of Syria, Iraq and Libya, Agent Hopper said. Other law enforcement officials said he called after beginning his assault. 